---
x-environment: &common-environment
  PGID: 1000
  PUID: 1000
  TZ: Europe/Berlin
  UMASK_SET: 022

x-common-volume-1: &common-volume-1 "cache-usenet:/data/usenet"
x-common-volume-2: &common-volume-2 "sh8-torrents:/data/torrents/sh8"

services:
  radarr:
    image: ghcr.io/linuxserver/radarr:5.15.1@sha256:c60610599d681dc7ea0aa1a5edfc1637ff4b5fb062872aea1539d291c835c4b3
    container_name: radarr
    hostname: radarr
    environment: *common-environment
    volumes:
      #TODO Change the backup folder in the web interface
      - backup:/backups
      - config:/config
      - media:/data/media/radarr
      - trash:/data/trash/radarr
      - *common-volume-1
      - *common-volume-2
    labels:
      - "de.panzer1119.docker.volume.default.cifs.host=op://Docker/Radarr/CIFS/Host"
      - "de.panzer1119.docker.volume.default.cifs.username=op://Docker/Radarr/CIFS/Username"
      - "de.panzer1119.docker.volume.default.cifs.password=op://Docker/Radarr/CIFS/Password"
      - "de.panzer1119.docker.volume.radarr-backup.cifs.share=op://Docker/Radarr/CIFS/Share_Backup"
      - "de.panzer1119.docker.volume.radarr-media.cifs.share=op://Docker/Radarr/CIFS/Share_Media"
      - "de.panzer1119.docker.volume.radarr-trash.cifs.share=op://Docker/Radarr/CIFS/Share_Trash"
    network_mode: bridge
    ports:
      - "7878:7878"
    restart: unless-stopped
    extends:
      file: ../../common/docker-compose.yml
      service: logging-gelf

  radarr-4k:
    image: ghcr.io/linuxserver/radarr:5.15.1@sha256:c60610599d681dc7ea0aa1a5edfc1637ff4b5fb062872aea1539d291c835c4b3
    container_name: radarr-4k
    hostname: radarr-4k
    environment: *common-environment
    volumes:
      #TODO Change the backup folder in the web interface
      - backup-4k:/backups
      - config-4k:/config
      - media-4k:/data/media/radarr-4k
      - trash-4k:/data/trash/radarr-4k
      - *common-volume-1
      - *common-volume-2
    labels:
      - "de.panzer1119.docker.volume.default.cifs.host=op://Docker/Radarr/CIFS/Host"
      - "de.panzer1119.docker.volume.default.cifs.username=op://Docker/Radarr/CIFS/Username"
      - "de.panzer1119.docker.volume.default.cifs.password=op://Docker/Radarr/CIFS/Password"
      - "de.panzer1119.docker.volume.radarr-backup-4k.cifs.share=op://Docker/Radarr/CIFS/Share_Backup_4K"
      - "de.panzer1119.docker.volume.radarr-media-4k.cifs.share=op://Docker/Radarr/CIFS/Share_Media_4K"
      - "de.panzer1119.docker.volume.radarr-trash-4k.cifs.share=op://Docker/Radarr/CIFS/Share_Trash_4K"
    network_mode: bridge
    ports:
      - "7474:7878"
    restart: unless-stopped
    extends:
      file: ../../common/docker-compose.yml
      service: logging-gelf

  radarr-anime:
    image: ghcr.io/linuxserver/radarr:5.15.1@sha256:c60610599d681dc7ea0aa1a5edfc1637ff4b5fb062872aea1539d291c835c4b3
    container_name: radarr-anime
    hostname: radarr-anime
    environment: *common-environment
    volumes:
      #TODO Change the backup folder in the web interface
      - backup-anime:/backups
      - config-anime:/config
      - media-anime:/data/media/radarr-anime
      - trash-anime:/data/trash/radarr-anime
      - *common-volume-1
      - *common-volume-2
    labels:
      - "de.panzer1119.docker.volume.default.cifs.host=op://Docker/Radarr/CIFS/Host"
      - "de.panzer1119.docker.volume.default.cifs.username=op://Docker/Radarr/CIFS/Username"
      - "de.panzer1119.docker.volume.default.cifs.password=op://Docker/Radarr/CIFS/Password"
      - "de.panzer1119.docker.volume.radarr-backup-anime.cifs.share=op://Docker/Radarr/CIFS/Share_Backup_Anime"
      - "de.panzer1119.docker.volume.radarr-media-anime.cifs.share=op://Docker/Radarr/CIFS/Share_Media_Anime"
      - "de.panzer1119.docker.volume.radarr-trash-anime.cifs.share=op://Docker/Radarr/CIFS/Share_Trash_Anime"
    network_mode: bridge
    ports:
      - "7171:7878"
    restart: unless-stopped
    extends:
      file: ../../common/docker-compose.yml
      service: logging-gelf

volumes:
  config:
    name: radarr-config
    driver: local
    driver_opts:
      type: none
      o: bind
      device: "/docker/config/radarr"
  config-4k:
    name: radarr-config-4k
    driver: local
    driver_opts:
      type: none
      o: bind
      device: "/docker/config/radarr-4k"
  config-anime:
    name: radarr-config-anime
    driver: local
    driver_opts:
      type: none
      o: bind
      device: "/docker/config/radarr-anime"
  cache-usenet:
    name: cache-usenet
    # This is defined in the sabnzbd compose file
    external: true
  backup:
    #TODO Move current backups to this volume
    name: radarr-backup
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  backup-4k:
    #TODO Move current backups to this volume
    name: radarr-backup-4k
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  backup-anime:
    #TODO Move current backups to this volume
    name: radarr-backup-anime
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  media:
    name: radarr-media
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  media-4k:
    name: radarr-media-4k
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  media-anime:
    name: radarr-media-anime
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  trash:
    name: radarr-trash
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  trash-4k:
    name: radarr-trash-4k
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  trash-anime:
    name: radarr-trash-anime
    # Because this is a cifs volume, and it needs credentials, it is created outside of this file
    external: true
  sh8-torrents:
    name: sh8-torrents
    driver: rclone
    driver_opts:
      remote: "sh8:"
      allow_other: "true"
      vfs_cache_mode: full
      poll_interval: 0
    labels:
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.type=sftp"
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.host=op://Docker/SH8/Host"
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.port=op://Docker/SH8/Port"
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.path=op://Docker/SH8/Path_Torrents"
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.username=op://Docker/SH8/Username"
      - "de.panzer1119.docker.volume.sh8-torrents.rclone.password=op://Docker/SH8/Password"
